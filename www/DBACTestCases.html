<!DOCTYPE html>
<html>

<head>
	<title>Frits</title>
	<meta charset="utf-8" />
	<!--<meta name="format-detection" content="telephone=no" />
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />-->
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<script src="js/lib/prototype-1.7.1.js"></script>
	<script src="js/lib/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/index.js"></script>
	<script src="js/class/localdb.class.js"></script>
	<!-- If this comment is removed the program will blow up -->
</head>
<body>
	<div id="header"><span id="left"><span id="back">&lt;</span></span>  
	<span id="center">Frits</span> 

	<span id="right"><span id="vraagteken">?</span></span></div>
	
	<div id="testReport" style="margin-top: 3em; font-size: 16px">
		Tests:
	</div>
	<script type="text/javascript">
		var db = null;
		var result = null;
		
		function setResult(i, res) {
			$('#test' + i).append(res ? 'Pass' : 'Fail');
		}
		
		function createDBTest(i) {
			db = new LocalDB(
				"CREATE TABLE IF NOT EXISTS `test`" + 
					"(`int` INTEGER, " + 
					"`text` TEXT, " +
					"`bool` BOOLEAN);",
				1
			);
			console.log(db.pError);
			setResult(i, !db.pError);
		}
		
		function insertTestPass(i) {
			db.insert( { int: 0, text: 'TestInsertPass', bool: false} ).done(
				function() { setResult(i, true); }
			).fail(
				function() { setResult(i, false); }
			);
		}
		
		function insertTestFail(i) {
			db.insert( { int: 0, text: 'TestInsertFail', bool: false, failParam: 'Fail'}).done(
				function() { setResult(i, false); }
			).fail(
				function() { setResult(i, true); }
			);
		}
		
		function removeTestPass(i) {
			db.insert( { int: 0, text: 'TestRemovePass', bool: false}).done(
				function() {
					db.deleteMatch( {text: 'TestRemovePass'} ).done(
						function() { setResult(i, true); }
					).fail(
						function() { setResult(i, false); }
					);
				}
			).fail(
				function() { setResult(i, false); }
			);
		}
		
		function removeTestFail(i) {
			db.insert( { int: 0, text: 'TestRemoveFail', bool: false}).done(
				function() {
					db.deleteMatch( {text: 'TestRemoveFall'} ).done(
						function() { setResult(i, true); }
					).fail(
						function() { setResult(i, false); }
					);
				}
			).fail(
				function() { setResult(i, false); }
			);
		}
		
		function selectOneTest(i) {
			
		}
		
		function selectMultipleTest(i) {
			
		}
		
		function generateDBACTestReport(tests) {
			var result = '<table border="2"><tr><td>ID</td><td>NAME</td><td>PASS/FAIL</td></tr>';
			$.each(tests, 
				function(i, e) {
					result = result + '<tr>' + 
					'<td>' + i + '</td>' + 
					'<td>' + e.name + '</td>' + 
					'<td id="test' + i + '"></td></tr>';
					e.test(i);
				}
			);
			
			return result + '</table>';
		}
		
		$(function()
		{
			var tests = [
			{
				name: 'Create', 
				test: createDBTest
			},
			{
				name: 'Insert Pass',
				test: insertTestPass
			},
			{
				name: 'Insert Fail',
				test: insertTestFail
			},
			{
				name: 'Remove Pass',
				test: removeTestPass
			},
			{
				name: 'Remove Fail',
				test: removeTestFail
			},
			{
				name: 'Select One',
				test: selectOneTest
			},
			{
				name: 'Select Multiple',
				test: selectMultipleTest
			}
			];
			var report = generateDBACTestReport(tests);
			$('#testReport').append(report);
		}
		);
	</script>
</body>
</html>